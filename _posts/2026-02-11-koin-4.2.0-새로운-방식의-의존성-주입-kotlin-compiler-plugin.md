---
title: "Koin 4.2.0 : ìƒˆë¡œìš´ ë°©ì‹ì˜ ì˜ì¡´ì„± ì£¼ì… - Kotlin Compiler Plugin"
date: 2026-02-11 00:41:00 +0900
categories:
  - Android
tags:
  - DI
  - Koin
comments: true
---
## Overview

Koin 4.2.0ì—ì„œ ê°€ì¥ í° ë³€í™”ëŠ” **Kotlin ì»´íŒŒì¼ëŸ¬ í”ŒëŸ¬ê·¸ì¸**ì˜ ë„ì…ì…ë‹ˆë‹¤. ì´ë²ˆ ê¸€ì—ì„œëŠ” ë¦¬í”Œë ‰ì…˜ ê¸°ë°˜ì—ì„œ ì»´íŒŒì¼ëŸ¬ ê¸°ë°˜ìœ¼ë¡œ ë°”ë€Œë©´ì„œ ì–´ë–¤ ì´ì ì„ ê°€ì ¸ë‹¤ì£¼ëŠ”ì§€ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.

---

## ğŸ¤” Kotlin Compiler Plugin?

Kotlin ì»´íŒŒì¼ëŸ¬ í”ŒëŸ¬ê·¸ì¸ì€ KSPë‚˜ ì–´ë…¸í…Œì´ì…˜ í”„ë¡œì„¸ì„œì™€ ë‹¤ë¥´ê²Œ ì‘ë™í•©ë‹ˆë‹¤. ì»´íŒŒì¼ì˜ ì´ˆê¸° ë‹¨ê³„ì—ì„œ ì½”ë“œë¥¼ ê°€ë¡œì±„ê³  ë³€í™˜í•©ë‹ˆë‹¤.

### ì£¼ìš” ì´ì 

- **ì§ì ‘ ì½”ë“œ ë¶„ì„** â€” ìƒì„±ì íŒŒë¼ë¯¸í„°, íƒ€ì…, í•œì •ìë¥¼ ì§ì ‘ ì´í•´
- **ì»´íŒŒì¼ íƒ€ì„ ë³€í™˜** â€” ëŸ°íƒ€ì„ ë¦¬í”Œë ‰ì…˜ ì—†ìŒ, ìƒì„±ë˜ëŠ” ì½”ë“œ íŒŒì¼ X
- **ë¹ ë¥¸ ì»´íŒŒì¼** â€” Kotlin ì»´íŒŒì¼ëŸ¬ íŒŒì´í”„ë¼ì¸ê³¼ ë„¤ì´í‹°ë¸Œ í†µí•©

Koin ì»´íŒŒì¼ëŸ¬ í”ŒëŸ¬ê·¸ì¸ì€ **Annotations ë¿ë§Œì•„ë‹ˆë¼ DSLë„ ê°™ì´** ì§€ì›í•˜ê¸° ë•Œë¬¸ì— DSL ë°©ì‹ì—ì„œë„ ê°œì„ ëœ ë°©ì‹ìœ¼ë¡œ ì»´íŒŒì¼ íƒ€ì„ ì•ˆì •ì„±ì„ ë³´ì¥ë°›ì„ ìˆ˜ ìˆê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤!

ìš”ì¦˜ ëœ¨ê³ ìˆëŠ” DI í”„ë ˆì„ì›Œí¬ì¸ [Metro](https://github.com/ZacSweers/metro)ì™€ ë¹„êµí–ˆì„ ë•Œ ë¶€ì¡±í•œ ì ì´ ì‚¬ë¼ì¡Œê¸° ë•Œë¬¸ì— ë„˜ì–´ê°ˆ ì´ìœ ë„ ì‚¬ë¼ì§„ ê²ƒ ê°™ìŠµë‹ˆë‹¤.

---

## í”„ë¡œì íŠ¸ ì„¤ì •

### í˜¸í™˜ì„±

- Kotlin 2.3.20-Beta1
- Koin 4.2.0-RC1
- Koin Compiler Plugin 0.3.0
- Gradle 8.x+

### ì„¤ì • ë°©ë²•

**`gradle/libs.versions.toml`:**

```toml
[versions]
koin = "4.2.0-RC1"
koin-plugin = "0.3.0"

[libraries]
koin-core = { module = "io.insert-koin:koin-core", version.ref = "koin" }
koin-annotations = { module = "io.insert-koin:koin-annotations", version.ref = "koin" }

[plugins]
koin-compiler = { id = "io.insert-koin.compiler.plugin", version.ref = "koin-plugin" }
```

**`build.gradle.kts`:**

```kotlin
plugins {
    alias(libs.plugins.koin.compiler)
}

dependencies {
    implementation(libs.koin.core)
    implementation(libs.koin.annotations) // ì–´ë…¸í…Œì´ì…˜ ì‚¬ìš© ì‹œ
}
```

`userLogs` í™œì„±í™” ì‹œ ì»´íŒŒì¼ëŸ¬ í”ŒëŸ¬ê·¸ì¸ì´ ê° Annotation ì»´í¬ë„ŒíŠ¸ì— ëŒ€í•´ ê°ì§€í•˜ê³  ìƒì„±í•˜ëŠ” ë¡œê·¸ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```kotlin
koinCompiler {
    userLogs = true
}
```

---

## Annotations ë°©ì‹ì—ì„œ ë§ˆì´ê·¸ë ˆì´ì…˜

ê¸°ì¡´ì— KSP ê¸°ë°˜ Koin Annotationsë¥¼ ì‚¬ìš©í•˜ê³  ìˆì—ˆë‹¤ë©´ ë§ˆì´ê·¸ë ˆì´ì…˜ì€ ê°„ë‹¨í•©ë‹ˆë‹¤.

1. KSP í”ŒëŸ¬ê·¸ì¸ê³¼ `ksp(libs.koin.ksp.compiler)` ì˜ì¡´ì„± ì œê±°
2. ìœ„ì™€ ê°™ì´ ìƒˆ ì»´íŒŒì¼ëŸ¬ í”ŒëŸ¬ê·¸ì¸ ì¶”ê°€
3. ì–´ë…¸í…Œì´ì…˜ì€ ê·¸ëŒ€ë¡œ ìœ ì§€: `@Single`, `@Factory`, `@Module` ë“± ë³€ê²½ ì—†ìŒ

#### í´ë˜ìŠ¤ & ìµœìƒìœ„ í•¨ìˆ˜ Annotations ì ìš©

```kotlin
@Singleton
class Database

@Singleton
class UserRepository(private val database: Database)

@Factory
class GetUserUseCase(private val repository: UserRepository)

@KoinViewModel
class UserViewModel(
    private val getUserUseCase: GetUserUseCase
) : ViewModel()
```

```kotlin
@Singleton
fun provideHttpClient(): HttpClient = HttpClient {
    // ì„¤ì •
}
```

#### ëª¨ë“ˆ

`@Module`ë¡œ ëª¨ë“ˆì„ ì •ì˜í•˜ê³ , ì„ íƒì ìœ¼ë¡œ `@ComponentScan`ìœ¼ë¡œ íŒ¨í‚¤ì§€ì˜ ì •ì˜ë¥¼ ìŠ¤ìº”

```kotlin
@Module
@ComponentScan("com.myapp.data")
class DataModule

@Module
@ComponentScan("com.myapp.domain")
class DomainModule

@Module(includes = [DataModule::class, DomainModule::class])
class AppModule
```

#### Configuration ìŠ¤ìºë‹

`@Configuration`ìœ¼ë¡œ ëª¨ë“ˆì„ ìë™ ê²€ìƒ‰ ê°€ëŠ¥í•˜ë„ë¡ í‘œì‹œ:

```kotlin
@Module
@ComponentScan("com.myapp") // ëŒ€ìƒ íŒ¨í‚¤ì§€ì—ì„œ ì •ì˜ ìŠ¤ìº”
@Configuration
class AppModule
```

Configuration ëª¨ë“ˆì€ ì‹œì‘ ì‹œ ìë™ìœ¼ë¡œ ìˆ˜ì§‘ë©ë‹ˆë‹¤.

#### JSR-330 í˜¸í™˜ì„±

ì»´íŒŒì¼ëŸ¬ í”ŒëŸ¬ê·¸ì¸ì€ í‘œì¤€ JSR-330 ì–´ë…¸í…Œì´ì…˜ì„ ì§€ì›í•©ë‹ˆë‹¤:

```kotlin
import jakarta.inject.Singleton
import jakarta.inject.Named

@Singleton
class MyService(@Named("api") val client: ApiClient)
```

`jakarta.inject.*`ì™€ `javax.inject.*` ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ëª¨ë‘ ì§€ì›ë©ë‹ˆë‹¤. ë˜í•œ `@Qualifier`ë¥¼ ì‚¬ìš©í•œ ì»¤ìŠ¤í…€ íƒ€ì… í•œì •ìë„ ì§€ì›ë©ë‹ˆë‹¤.

---

## DSL ë°©ì‹ì—ì„œ ë§ˆì´ê·¸ë ˆì´ì…˜

**ì£¼ì˜ :** ìƒˆë¡œìš´ Koin ì»´íŒŒì¼ëŸ¬ DSL API íŒ¨í‚¤ì§€ê°€ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.

```kotlin
org.koin.plugin.module.dsl.*
```

ê¸°ì¡´ì˜ DSL ì •ì˜ ë°©ì‹ì— ë¹„í•´ ì¢€ ë” ì‚¬ìš©í•˜ê¸° í¸í•´ì¡ŒìŠµë‹ˆë‹¤.

```kotlin
import org.koin.plugin.module.dsl.*
import org.koin.dsl.module

val appModule = module {
    single<Database>()
    single<UserRepository>()
    factory<UserPresenter>()
    viewModel<UserViewModel>()
}
```

`single<UserRepository>()`ë¥¼ ì‘ì„±í•˜ë©´ ì»´íŒŒì¼ëŸ¬ í”ŒëŸ¬ê·¸ì¸ì´ ìƒì„±ìë¥¼ ë¶„ì„í•˜ê³  ë‹¤ìŒê³¼ ê°™ì´ ë³€í™˜í•©ë‹ˆë‹¤

```kotlin
single { UserRepository(get()) }
```

#### create()

ëŒë‹¤ ë‚´ì—ì„œ ëª…ì‹œì  ìƒì„±ì„ ìœ„í•´ `create(::T)` ì‚¬ìš©

```kotlin
val appModule = module {
    single {
        create(::provideHttpClient)
    }
}

fun provideHttpClient(): HttpClient = HttpClient {
    // ì„¤ì •
}
```

`create()` í•¨ìˆ˜ í˜¸ì¶œë„ ë§ˆì°¬ê°€ì§€ë¡œ í•¨ìˆ˜ ì‹œê·¸ë‹ˆì²˜ì—ì„œ í•„ìš”í•œ íŒŒë¼ë¯¸í„°ë¥¼ ê°ì§€í•©ë‹ˆë‹¤.

#### Includes

ëª¨ë“ˆ êµ¬ì„±ì€ ì˜ˆìƒëŒ€ë¡œ ì‘ë™í•©ë‹ˆë‹¤

```kotlin
val networkModule = module {
    single<HttpClient>()
    single<ApiService>()
}

val repositoryModule = module {
    includes(networkModule)
    single<UserRepository>()
}
```

### ëª…ì‹œì  ë°”ì¸ë”©

DSLë¡œ ì¸í„°í˜ì´ìŠ¤ë¥¼ ëª…ì‹œì ìœ¼ë¡œ ë°”ì¸ë”©

```kotlin
val appModule = module {
    single<UserRepositoryImpl>() bind UserRepository::class
    
    // ë‹¤ì¤‘ ë°”ì¸ë”©
    single<MyServiceImpl>() binds arrayOf(
        ServiceA::class,
        ServiceB::class
    )
}
```

### í•œì •ì / íŒŒë¼ë¯¸í„° ì£¼ì…

í•œì •ìë‚˜ ëŸ°íƒ€ì„ íŒŒë¼ë¯¸í„°ê°€ í•„ìš”í•œ ê²½ìš°, í´ë˜ìŠ¤ì— ì–´ë…¸í…Œì´ì…˜ ì‚¬ìš©

```kotlin
class UserPresenter(
    @Named("api") val client: ApiClient,        // í•œì •ëœ ì˜ì¡´ì„±
    @InjectedParam val userId: String,          // ëŸ°íƒ€ì„ íŒŒë¼ë¯¸í„°
    @Property("api_url") val url: String        // í”„ë¡œí¼í‹° ì£¼ì…
)
```

íŒŒë¼ë¯¸í„° ì£¼ì…

```kotlin
val presenter: UserPresenter = get { parametersOf("user123") }
```


---

## KMP / CMP

í”ŒëŸ¬ê·¸ì¸ì€ ëª¨ë“  KMP íƒ€ê²Ÿì—ì„œ ì‘ë™í•©ë‹ˆë‹¤
- Android, iOS (arm64, x64, simulatorArm64)
- JVM, JS, Wasm
- macOS, Linux, Windows

```kotlin
// shared/build.gradle.kts
plugins {
    kotlin("multiplatform")
    id("io.insert-koin.compiler.plugin")
}

kotlin {
    androidTarget()
    iosX64()
    iosArm64()
    iosSimulatorArm64()

    sourceSets {
        commonMain.dependencies {
            implementation("io.insert-koin:koin-core:4.2.0-RC1")
            implementation("io.insert-koin:koin-annotations:4.2.0-RC1")
        }
    }
}
```

#### Common & Native ì½”ë“œ ê°„ ìŠ¤ìºë‹

ì»´íŒŒì¼ëŸ¬ í”ŒëŸ¬ê·¸ì¸ì€ ëª¨ë“  SourceSetì„ ìŠ¤ìº”í•©ë‹ˆë‹¤.

```kotlin
// commonMain
@Singleton
class UserRepository(private val database: Database)

@Module
@ComponentScan
class SharedModule

@Singleton
expect class PlatformDatabase : Database
```

ê° SourceSetì—ì„œ í”Œë«í¼ë³„ êµ¬í˜„

```kotlin
// androidMain
@Singleton
actual class PlatformDatabase : Database {
    // Android SQLite êµ¬í˜„
}

// iosMain
@Singleton
actual class PlatformDatabase : Database {
    // iOS Core Data êµ¬í˜„
}
```

í”ŒëŸ¬ê·¸ì¸ì€ `expect/actual` íŒ¨í„´ì„ ìë™ìœ¼ë¡œ ì²˜ë¦¬í•©ë‹ˆë‹¤. ë˜í•œ ìƒì„±ì ì œì•½ì„ í”¼í•˜ê±°ë‚˜ `expect/actual`ì„ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë ¤ë©´ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì§ì ‘ ìŠ¤ìº”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```kotlin
// commonMain
@Singleton
class UserRepository(private val database: Database)

@Module
@ComponentScan
class SharedModule

// ì—¬ê¸°ì„œ ì¸í„°í˜ì´ìŠ¤ë§Œ ì •ì˜
interface Database

// Native êµ¬í˜„

// androidMain
@Singleton
class PlatformDatabase(val context: Context) : Database {
    // Android SQLite êµ¬í˜„
}

// iosMain
@Singleton
class PlatformDatabase : Database {
    // iOS Core Data êµ¬í˜„
}
```

#### Compose Multiplatform

Compose Multiplatform ì•±ì˜ ê²½ìš° íƒ€ì…ì´ ì§€ì •ëœ ì„¤ì •ê³¼ í•¨ê»˜ `KoinApplication()` composable í•¨ìˆ˜ ì‚¬ìš©

```kotlin
@KoinApplication
class MyKoinApp

@Composable
fun App() {
    KoinApplication(application = withConfiguration<MyKoinApp>()) {
        // Compose ì½˜í…ì¸ 
        MainScreen()
    }
}
```

Android, iOS, Desktop, Web ë“± ëª¨ë“  Compose íƒ€ê²Ÿì—ì„œ ì‘ë™í•©ë‹ˆë‹¤.

---

## Conclusion

#### Koin Annotations KSP : ë‹¹ì¥ ë§ˆì´ê·¸ë ˆì´ì…˜ ì¶”ì²œ!

ì´ë¯¸ KSPì™€ í•¨ê»˜ Koin Annotationsë¥¼ ì‚¬ìš©í•˜ê³  ìˆë‹¤ë©´ ê°„ë‹¨íˆ ë§ˆì´ê·¸ë ˆì´ì…˜ì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

1. í”„ë¡œì íŠ¸ì—ì„œ KSP ì œê±°
2. Koin ì»´íŒŒì¼ëŸ¬ í”ŒëŸ¬ê·¸ì¸ ì¶”ê°€
3. Annotations ë³€ê²½ X

#### Koin DSL : ì ì§„ì  ë§ˆì´ê·¸ë ˆì´ì…˜

Koin DSLì„ ì‚¬ìš©í•˜ê³  ìˆë‹¤ë©´ ë§ˆì´ê·¸ë ˆì´ì…˜ì„ ì„œë‘ë¥¼ í•„ìš”ê°€ ì—†ì§€ë§Œ, ë” ì•ˆì „í•œ DSLë¡œ ì „í™˜í•˜ì—¬ ì»´íŒŒì¼ ì•ˆì „ì„±ì˜ ì´ì ì„ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤!

DSL ë§ˆì´ê·¸ë ˆì´ì…˜ ê°€ì´ë“œ

- ì»´íŒŒì¼ëŸ¬ í”ŒëŸ¬ê·¸ì¸ DSL(`single<T>()` ë“±)ì„ ì‚¬ìš©í•˜ì—¬ ìƒˆ ëª¨ë“ˆ ì‹œì‘
- ê¸°ì¡´ ëª¨ë“ˆì„ ìˆ˜ì •í•  ë•Œ ì ì§„ì ìœ¼ë¡œ ë³€í™˜
- ì „í™˜ ê¸°ê°„ ë™ì•ˆ ë™ì¼í•œ í”„ë¡œì íŠ¸ì—ì„œ ë‘ ì ‘ê·¼ ë°©ì‹ í˜¼í•©

---

## Reference

- Koin Powered by Kotlin Compiler â€” https://blog.insert-koin.io/koin-powered-by-kotlin-compiler-0722f1cc96a4
- ëª¨ë“  í”Œë«í¼ ì„¤ì • ê°€ì´ë“œ â€” https://insert-koin.io/docs/setup/compiler-plugin
- DSL ë ˆí¼ëŸ°ìŠ¤ â€” https://insert-koin.io/docs/reference/koin-core/dsl
- Annotations ë¦¬ìŠ¤íŠ¸ â€” https://insert-koin.io/docs/reference/koin-annotations/annotations-inventory
- KSP to Compiler Plugin ë§ˆì´ê·¸ë ˆì´ì…˜ ê°€ì´ë“œ â€” https://insert-koin.io/docs/migration/from-ksp-to-compiler-plugin